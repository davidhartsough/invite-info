const getEl=t=>document.getElementById(t),form=getEl("form"),titleInputEl=getEl("title"),startInputEl=getEl("start"),endInputEl=getEl("end"),locationInputEl=getEl("location"),descriptionInputEl=getEl("description"),linkInputEl=getEl("link"),emailInputEl=getEl("email");function getOneWeekFromNow(){const t=new Date;return t.setDate(t.getDate()+7),t.setHours(19,0,0,0),`${t.toISOString().slice(0,11)}19:00`}function getMinDT(){const t=new Date;return t.setHours(1,1,0,0),`${t.toISOString().slice(0,11)}01:00`}function getMaxDT(){const t=new Date;return t.setDate(t.getDate()+7),t.setFullYear(t.getFullYear()+1),t.setMonth(t.getMonth()+2),t.setHours(23,0,0,0),`${t.toISOString().slice(0,11)}19:00`}startInputEl.value=getOneWeekFromNow(),startInputEl.setAttribute("min",getMinDT()),startInputEl.setAttribute("max",getMaxDT()),endInputEl.value="20:00";const urlPattern=/^(https?:\/\/)((?!-)(?!.*--)[a-zA-Z\-0-9]{1,63}(?<!-)\.)+[a-zA-Z]{2,63}(\/[^\s]*)?$/,emailPattern=/^([^<>()[\]\\.,;:\s@"]{1,63})@((((?!-)(?!.*--)[a-zA-Z\-0-9]{1,63}(?<!-))+\.)+([a-zA-Z]{2,63}))$/,startPattern=/^(20[2-9]{1}[2-9]{1}-[0-1]{1}[0-9]{1}-[0-3]{1}[0-9]{1}T[0-2]{1}[0-9]{1}:[0-5]{1}[0-9]{1})$/,endPattern=/^([0-2]{1}[0-9]{1}:[0-5]{1}[0-9]{1})$/,getTimestamp=t=>new Date(t).getTime();form.addEventListener("submit",async t=>{t.preventDefault();const s=titleInputEl.value.trim();if(!s||s.length<2||s.length>80)return titleInputEl.focus(),!1;const o=startInputEl.value;if(!o||!startPattern.test(o))return startInputEl.focus(),!1;const l=endInputEl.value;if(!l||!endPattern.test(l))return endInputEl.focus(),!1;const c=locationInputEl.value.trim();if(c.length<2||c.length>140)return locationInputEl.focus(),!1;const r=descriptionInputEl.value.trim();if(r.length<2||r.length>800)return descriptionInputEl.focus(),!1;const n=linkInputEl.value;if(n&&n.length>0&&(n.length>150||!urlPattern.test(n)))return linkInputEl.focus(),!1;const e=emailInputEl.value;if(e&&e.length>0&&(e.length>150||!emailPattern.test(e)))return e.focus(),!1;const f=getTimestamp(o);let u=getTimestamp(`${o.slice(0,11)}${l}`);u-f<0&&(u+=864e5);const i={title:s,start:f,end:u,location:c,description:r};n&&(i.link=n),e&&(i.email=e),console.log("eventInfo:",i);const p=await fetch("https://invite-info.web.app/api/create",{method:"POST",headers:{"Content-Type":"application/json"},body:{eventInfo:i}}),{info:a}=await p.json();return console.log("info:",a),window.localStorage.setItem(a.id,JSON.stringify(a)),window.location.href=`https://invite-info.web.app/event/?i=${a.id}`,!1});
